{% extends 'base.html' %}
{% block content %}
<div class="container">
    <h2 style="margin-top: 10px;">Service Detail</h2>
    <table class="table">
        <tr>
            <th>ID Car Service</th>
            <td>{{ car_service.id }}</td>
        </tr>
        <tr>
            <th>Username Pendaftar</th>
            <td>{{ car_service.user.username }}</td>
        </tr>
        <tr>
            <th>Plat Nomor</th>
            <td>{{ car_service.license_plate }}</td>
        </tr>
        <tr>
            <th>Merek / Tipe Mobil</th>
            <td>{{ car_service.brand }}</td>
        </tr>
        <tr>
            <th>Tanggal Servis</th>
            <td>{{ car_service.service_date }}</td>
        </tr>
        <tr>
            <th>Nama Tukang Servis</th>
            <td>{{ car_service.techinician_name }}</td>
        </tr>
        <tr>
            <th>Nomor Telepon Tukang Servis</th>
            <td>{{ car_service.techinician_phone }}</td>
        </tr>
        <tr>
            <th>Daftar Part Servis</th>
            <td>
                {% for part_to_service in parts_to_service_list %}
                    <p>
                        <strong>Nama Servis Part {{ forloop.counter }}:</strong><br>
                        {{ part_to_service.parts_to_service }}
                    </p>
                    <p>
                        <strong>Foto Servis Part {{ forloop.counter }}:</strong><br>
                        <img src="{{ part_to_service.car_photo.url }}" alt="{{ part_to_service.parts_to_service }} Photo" width="200"><br>
                        <a href="{{ part_to_service.car_photo.url }}" target="_blank" class="btn btn-info">View Photo</a>
                    </p>
                    <form method="post">
                        {% csrf_token %}
                        <input type="hidden" name="car_service_id" value="{{ car_service.id }}">
                        <input type="hidden" name="part_to_service_id" value="{{ part_to_service.id }}">
                        {% if part_to_service.is_approved %}
                            Disetujui &#9989;
                        {% elif part_to_service.is_rejected %}
                            Ditolak &#10060;
                        {% else %}
                            <button type="submit" name="action" value="approve" class="btn btn-success">Accept</button>
                            <button type="submit" name="action" value="reject" class="btn btn-danger">Reject</button>
                        {% endif %}
                    </form>
                    <br>
                    <br>
                {% endfor %}
            </td>
        </tr>
    </table>
    <a href="{% url 'staff:service_approval_list' %}" class="btn btn-primary">Kembali ke Approval List</a>

    {% if is_completed %}
        <a href="{% url 'staff:generate_pdf' car_service.id %}" class="btn btn-danger">Buat PDF</a>
        <a href="{{ whatsapp_link }}" class="btn btn-success" target="_blank">Kirim Pesan WhatsApp</a>
    {% endif %}
    <p></p>
</div>
{% endblock content %}
